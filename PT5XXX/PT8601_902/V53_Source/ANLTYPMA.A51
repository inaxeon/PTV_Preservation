$NOMOD51		;Disable the predefined 8051 register set

$INCLUDE( REG320.INC)		;Include the predefined 8052 register set
$INCLUDE( MACROS.INC)		;Include user defined macros

;************************************************************************
;* Copyright PHILIPS TV TEST EQUIPMENT A/S, BRONDBY 1997		*
;* Project: PT8601 Analog Test Signal generator				*
;* Module:  ANLTYPMA.A51						*
;* Author:  Kim Engedahl, DEV						*
;* Org.  :  970320							*
;* Rev.  :  990613, KEn DEV						*
;* Status:  Version 1.0							*
;* 									*
;* This module contains the following functions:			*
;* 									*
;*	MA1_F1L20							*
;*	MA2_F1L20							*
;*	MA3_F1L20							*
;*	MA4_F1L20							*
;*	MA5_F1L20							*
;*	MA6_F1L20							*
;* 									*
;* Changes: 								*
;* 990613: Renamed pattern types					*
;* 990613: SReleasing as SW 1.2						*
;* 									*
;* Type 1 pattern: 262							*
;* Type 2 pattern: 29,1,1,1,1,29,119,62					*
;* Type 3 pattern: 163,19,61 						*
;* Type 4 pattern: 52,56,19,19,19,78					*
;* Type 5 pattern: 13,1,12,1,32,55,8,1,8,55,32,1,12,1,12		*
;* Type 6 pattern: 8,1,16,1,17,1,16,1,17,1,16,1,17,1,16,1,17,1,16,1,17,	*
;*		   1,16,1,17,1,16,1,7					*
;* 									*
;* NB! Placering af tekst aftalt med BLï¿½ 970522, kl ca. 11.00. Han ta'r	*
;*     skraldet hvis der kommer klager					*
;************************************************************************

NAME	TypeMA_LineRoutines

PUBLIC	MA1_F1L20, MA2_F1L20, MA3_F1L20, MA4_F1L20, MA5_F1L20, MA6_F1L20

EXTRN CODE( GenericMSBPort, LineAdrPort)

EXTRN DATA( StatusPort, Status)

EXTRN DATA( PatternPtr)				;Used in ReturnLineCntIntr
EXTRN BIT( Text1Enable, Status_S0, Status_TXT_ON)

;************************************************************************

MA_LineRoutine_Code	SEGMENT	CODE
	RSEG	MA_LineRoutine_Code
	USING	1

;************************************************************************
;* Type 1:  262
;* Field n: 20,22,38
;* Timing:  Worst case: +23 cycles
;************************************************************************
MA1_F1L20:
	UpdateType1 -2, MA1_F1L22	;+20
;************************************************************************
MA1_F1L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType1 -16, MA1_F1L38	;+20
;************************************************************************
MA1_F1L38:
	CLR	Status_TXT_ON		;+1 Clear possible text

	UpdateType1 -244, MA1_F2L20	;+20
;************************************************************************
MA1_F2L20:
	UpdateType1 -2, MA1_F2L22	;+20
;************************************************************************
MA1_F2L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType1 -16, MA1_F2L38	;+20
;************************************************************************
MA1_F2L38:
	CLR	Status_TXT_ON		;+1 Clear possible text

	UpdateType1 -245, MA1_F1L20	;+20


;************************************************************************
;* Type 2:  29,1,1,1,1,29,119,62 
;* Field n: 20,22,38,49,50,51,52,53,82,201
;* Timing:  Worst case: +34 cycles
;************************************************************************
MA2_F1L20:
	MOV	R5, PatternPtr		;+2
	MOV	R6, PatternPtr+1	;+2

	UpdateType2 1, -2, MA2_F1L22	;+30
;************************************************************************
MA2_F1L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType2 0, -16, MA2_F1L38	;+20
;************************************************************************
MA2_F1L38:
	CLR	Status_TXT_ON		;+1

	UpdateType2 0, -11, MA2_F1L49	;+20
;************************************************************************
MA2_F1L49:
	UpdateType2 1, -1, MA2_F1L50	;+30
;************************************************************************
MA2_F1L50:
	UpdateType2 1, -1, MA2_F1L51	;+30
;************************************************************************
MA2_F1L51:
	UpdateType2 1, -1, MA2_F1L52	;+30
;************************************************************************
MA2_F1L52:
	UpdateType2 1, -1, MA2_F1L53	;+30
;************************************************************************
MA2_F1L53:
	UpdateType2 1, -29, MA2_F1L82	;+30
;************************************************************************
MA2_F1L82:
	UpdateType2 1, -119, MA2_F1L201	;+30
;************************************************************************
MA2_F1L201:
	UpdateType2 1, -81, MA2_F2L20	;+30
;************************************************************************
MA2_F2L20:
	MOV	R5, PatternPtr		;+2
	MOV	R6, PatternPtr+1	;+2

	UpdateType2 1, -2, MA2_F2L22	;+30
;************************************************************************
MA2_F2L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType2 0, -16, MA2_F2L38	;+20
;************************************************************************
MA2_F2L38:
	CLR	Status_TXT_ON		;+1

	UpdateType2 0, -11, MA2_F2L49	;+20
;************************************************************************
MA2_F2L49:
	UpdateType2 1, -1, MA2_F2L50	;+30
;************************************************************************
MA2_F2L50:
	UpdateType2 1, -1, MA2_F2L51	;+30
;************************************************************************
MA2_F2L51:
	UpdateType2 1, -1, MA2_F2L52	;+30
;************************************************************************
MA2_F2L52:
	UpdateType2 1, -1, MA2_F2L53	;+30
;************************************************************************
MA2_F2L53:
	UpdateType2 1, -29, MA2_F2L82	;+30
;************************************************************************
MA2_F2L82:
	UpdateType2 1, -119, MA2_F2L201	;+30
;************************************************************************
MA2_F2L201:
	UpdateType2 1, -82, MA2_F1L20	;+30


;************************************************************************
;* Type 3:  163,19,61
;* Field n: 20,22,38,183,202
;* Timing:  Worst case: +34 cycles
;************************************************************************
MA3_F1L20:
	MOV	R5, PatternPtr		;+2
	MOV	R6, PatternPtr+1	;+2

	UpdateType2 1, -2, MA3_F1L22	;+30
;************************************************************************
MA3_F1L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType2 0, -16, MA3_F1L38	;+20
;************************************************************************
MA3_F1L38:
	CLR	Status_TXT_ON		;+1 Clear possible text

	UpdateType2 0, -145, MA3_F1L183	;+20
;************************************************************************
MA3_F1L183:
	UpdateType2 1, -19, MA3_F1L202	;+30
;************************************************************************
MA3_F1L202:
	UpdateType2 1, -80, MA3_F2L20	;+30
;************************************************************************
MA3_F2L20:
	MOV	R5, PatternPtr		;+2
	MOV	R6, PatternPtr+1	;+2

	UpdateType2 1, -2, MA3_F2L22	;+30
;************************************************************************
MA3_F2L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType2 0, -16, MA3_F2L38	;+20
;************************************************************************
MA3_F2L38:
	CLR	Status_TXT_ON		;+1 Clear possible text

	UpdateType2 0, -145, MA3_F2L183	;+20
;************************************************************************
MA3_F2L183:
	UpdateType2 1, -19, MA3_F2L202	;+30
;************************************************************************
MA3_F2L202:
	UpdateType2 1, -81, MA3_F1L20	;+30


;************************************************************************
;* Type 4:  52,56,19,19,19,78
;* Field n: 20,22,38,72,128,147,166,185
;* Timing:  Worst case: +34 cycles
;************************************************************************
MA4_F1L20:
	MOV	R5, PatternPtr		;+2
	MOV	R6, PatternPtr+1	;+2

	UpdateType2 1, -2, MA4_F1L22	;+30
;************************************************************************
MA4_F1L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType2 0, -16, MA4_F1L38	;+20
;************************************************************************
MA4_F1L38:
	CLR	Status_TXT_ON		;+1 Clear possible text

	UpdateType2 0, -34, MA4_F1L72	;+20
;************************************************************************
MA4_F1L72:
	UpdateType2 1, -56, MA4_F1L128	;+30
;************************************************************************
MA4_F1L128:
	UpdateType2 1, -19, MA4_F1L147	;+30
;************************************************************************
MA4_F1L147:
	UpdateType2 1, -19, MA4_F1L166	;+30
;************************************************************************
MA4_F1L166:
	UpdateType2 1, -19, MA4_F1L185	;+30
;************************************************************************
MA4_F1L185:
	UpdateType2 1, -97, MA4_F2L20	;+30
;************************************************************************
MA4_F2L20:
	MOV	R5, PatternPtr		;+2
	MOV	R6, PatternPtr+1	;+2

	UpdateType2 1, -2, MA4_F2L22	;+30
;************************************************************************
MA4_F2L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType2 0, -16, MA4_F2L38	;+20
;************************************************************************
MA4_F2L38:
	CLR	Status_TXT_ON		;+1 Clear possible text

	UpdateType2 0, -34, MA4_F2L72	;+20
;************************************************************************
MA4_F2L72:
	UpdateType2 1, -56, MA4_F2L128	;+30
;************************************************************************
MA4_F2L128:
	UpdateType2 1, -19, MA4_F2L147	;+30
;************************************************************************
MA4_F2L147:
	UpdateType2 1, -19, MA4_F2L166	;+30
;************************************************************************
MA4_F2L166:
	UpdateType2 1, -19, MA4_F2L185	;+30
;************************************************************************
MA4_F2L185:
	UpdateType2 1, -98, MA4_F1L20	;+30


;************************************************************************
;* Type 5:  12,1,12,1,32,55,8,1,8,55,32,1,12,1,12
;* Field n: 20,22,32,33,38,45,46,78,133,141,142,150,205,237,238,250,251
;* Timing:  Worst case: +34 cycles
;************************************************************************
MA5_F1L20:
	MOV	R5, PatternPtr		;+2
	MOV	R6, PatternPtr+1	;+2

	UpdateType2 1, -2, MA5_F1L22	;+30
;************************************************************************
MA5_F1L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType2 0, -10, MA5_F1L32	;+20
;************************************************************************
MA5_F1L32:
	UpdateType2 1, -1, MA5_F1L33	;+30
;************************************************************************
MA5_F1L33:
	UpdateType2 1, -5, MA5_F1L38	;+30
;************************************************************************
MA5_F1L38:
	CLR	Status_TXT_ON		;+1 Clear possible text

	UpdateType2 0, -7, MA5_F1L45	;+20
;************************************************************************
MA5_F1L45:
	UpdateType2 1, -1, MA5_F1L46	;+30
;************************************************************************
MA5_F1L46:
	UpdateType2 1, -32, MA5_F1L78	;+30
;************************************************************************
MA5_F1L78:
	UpdateType2 1, -55, MA5_F1L133	;+30
;************************************************************************
MA5_F1L133:
	UpdateType2 1, -8, MA5_F1L141	;+30
;************************************************************************
MA5_F1L141:
	UpdateType2 1, -1, MA5_F1L142	;+30
;************************************************************************
MA5_F1L142:
	UpdateType2 1, -8, MA5_F1L150	;+30
;************************************************************************
MA5_F1L150:
	UpdateType2 1, -55, MA5_F1L205	;+30
;************************************************************************
MA5_F1L205:
	UpdateType2 1, -32, MA5_F1L237	;+30
;************************************************************************
MA5_F1L237:
	UpdateType2 1, -1, MA5_F1L238	;+30
;************************************************************************
MA5_F1L238:
	UpdateType2 1, -12, MA5_F1L250	;+30
;************************************************************************
MA5_F1L250:
	UpdateType2 1, -1, MA5_F1L251	;+30
;************************************************************************
MA5_F1L251:
	UpdateType2 1, -31, MA5_F2L20	;+30
;************************************************************************
MA5_F2L20:
	MOV	R5, PatternPtr		;+2
	MOV	R6, PatternPtr+1	;+2

	UpdateType2 1, -2, MA5_F2L22	;+30
;************************************************************************
MA5_F2L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType2 0, -10, MA5_F2L32	;+20
;************************************************************************
MA5_F2L32:
	UpdateType2 1, -1, MA5_F2L33	;+30
;************************************************************************
MA5_F2L33:
	UpdateType2 1, -5, MA5_F2L38	;+30
;************************************************************************
MA5_F2L38:
	CLR	Status_TXT_ON		;+1 Clear possible text

	UpdateType2 0, -7, MA5_F2L45	;+20
;************************************************************************
MA5_F2L45:
	UpdateType2 1, -1, MA5_F2L46	;+30
;************************************************************************
MA5_F2L46:
	UpdateType2 1, -32, MA5_F2L78	;+30
;************************************************************************
MA5_F2L78:
	UpdateType2 1, -55, MA5_F2L133	;+30
;************************************************************************
MA5_F2L133:
	UpdateType2 1, -8, MA5_F2L141	;+30
;************************************************************************
MA5_F2L141:
	UpdateType2 1, -1, MA5_F2L142	;+30
;************************************************************************
MA5_F2L142:
	UpdateType2 1, -8, MA5_F2L150	;+30
;************************************************************************
MA5_F2L150:
	UpdateType2 1, -55, MA5_F2L205	;+30
;************************************************************************
MA5_F2L205:
	UpdateType2 1, -32, MA5_F2L237	;+30
;************************************************************************
MA5_F2L237:
	UpdateType2 1, -1, MA5_F2L238	;+30
;************************************************************************
MA5_F2L238:
	UpdateType2 1, -12, MA5_F2L250	;+30
;************************************************************************
MA5_F2L250:
	UpdateType2 1, -1, MA5_F2L251	;+30
;************************************************************************
MA5_F2L251:
	UpdateType2 1, -32, MA5_F1L20	;+30


;************************************************************************
;* Type 6:  8,1,16,1,17, 1,16,1,17, 1,16,1,17, 1,16,1,17, 1,16,1,17,	*
;*	 	         1,16,1,17, 1,16,1,7				*
;* Field n: 20,22,28,29,38,45,46,63,
;*          64,80,81,98, 99,115,116,133, 134,150,151,168, 169,185,186,203,
;*          204,220,221,238, 239,255,256
;* Timing:  Worst case: +34 cycles
;************************************************************************
MA6_F1L20:
	MOV	R5, PatternPtr		;+2
	MOV	R6, PatternPtr+1	;+2

	UpdateType2 1, -2, MA6_F1L22	;+30
;************************************************************************
MA6_F1L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType2 0, -6, MA6_F1L28	;+20
;************************************************************************
MA6_F1L28:
	UpdateType2 1, -1, MA6_F1L29	;+30
;************************************************************************
MA6_F1L29:
	UpdateType2 1, -9, MA6_F1L38	;+30
;************************************************************************
MA6_F1L38:
	CLR	Status_TXT_ON		;+1 Clear possible text

	UpdateType2 0, -7, MA6_F1L45	;+20
;************************************************************************
MA6_F1L45:
	UpdateType2 1, -1, MA6_F1L46	;+30
;************************************************************************
MA6_F1L46:
	UpdateType2 1, -17, MA6_F1L63	;+30
;************************************************************************
MA6_F1L63:
	UpdateType2 1, -1, MA6_F1L64	;+30
;************************************************************************
MA6_F1L64:
	UpdateType2 1, -16, MA6_F1L80	;+30
;************************************************************************
MA6_F1L80:
	UpdateType2 1, -1, MA6_F1L81	;+30
;************************************************************************
MA6_F1L81:
	UpdateType2 1, -17, MA6_F1L98	;+30
;************************************************************************
MA6_F1L98:
	UpdateType2 1, -1, MA6_F1L99	;+30
;************************************************************************
MA6_F1L99:
	UpdateType2 1, -16, MA6_F1L115	;+30
;************************************************************************
MA6_F1L115:
	UpdateType2 1, -1, MA6_F1L116	;+30
;************************************************************************
MA6_F1L116:
	UpdateType2 1, -17, MA6_F1L133	;+30
;************************************************************************
MA6_F1L133:
	UpdateType2 1, -1, MA6_F1L134	;+30
;************************************************************************
MA6_F1L134:
	UpdateType2 1, -16, MA6_F1L150	;+30
;************************************************************************
MA6_F1L150:
	UpdateType2 1, -1, MA6_F1L151	;+30
;************************************************************************
MA6_F1L151:
	UpdateType2 1, -17, MA6_F1L168	;+30
;************************************************************************
MA6_F1L168:
	UpdateType2 1, -1, MA6_F1L169	;+30
;************************************************************************
MA6_F1L169:
	UpdateType2 1, -16, MA6_F1L185	;+30
;************************************************************************
MA6_F1L185:
	UpdateType2 1, -1, MA6_F1L186	;+30
;************************************************************************
MA6_F1L186:
	UpdateType2 1, -17, MA6_F1L203	;+30
;************************************************************************
MA6_F1L203:
	UpdateType2 1, -1, MA6_F1L204	;+30
;************************************************************************
MA6_F1L204:
	UpdateType2 1, -16, MA6_F1L220	;+30
;************************************************************************
MA6_F1L220:
	UpdateType2 1, -1, MA6_F1L221	;+30
;************************************************************************
MA6_F1L221:
	UpdateType2 1, -17, MA6_F1L238	;+30
;************************************************************************
MA6_F1L238:
	UpdateType2 1, -1, MA6_F1L239	;+30
;************************************************************************
MA6_F1L239:
	UpdateType2 1, -16, MA6_F1L255	;+30
;************************************************************************
MA6_F1L255:
	UpdateType2 1, -1, MA6_F1L256	;+30
;************************************************************************
MA6_F1L256:
	UpdateType2 1, -26, MA6_F2L20	;+30
;************************************************************************
MA6_F2L20:
	MOV	R5, PatternPtr		;+2
	MOV	R6, PatternPtr+1	;+2

	UpdateType2 1, -2, MA6_F2L22	;+30
;************************************************************************
MA6_F2L22:
	MOV	C, Text1Enable		;+1
	MOV	Status_TXT_ON, C	;+2

	UpdateType2 0, -6, MA6_F2L28	;+20
;************************************************************************
MA6_F2L28:
	UpdateType2 1, -1, MA6_F2L29	;+30
;************************************************************************
MA6_F2L29:
	UpdateType2 1, -9, MA6_F2L38	;+30
;************************************************************************
MA6_F2L38:
	CLR	Status_TXT_ON		;+1 Clear possible text

	UpdateType2 0, -7, MA6_F2L45	;+20
;************************************************************************
MA6_F2L45:
	UpdateType2 1, -1, MA6_F2L46	;+30
;************************************************************************
MA6_F2L46:
	UpdateType2 1, -17, MA6_F2L63	;+30
;************************************************************************
MA6_F2L63:
	UpdateType2 1, -1, MA6_F2L64	;+30
;************************************************************************
MA6_F2L64:
	UpdateType2 1, -16, MA6_F2L80	;+30
;************************************************************************
MA6_F2L80:
	UpdateType2 1, -1, MA6_F2L81	;+30
;************************************************************************
MA6_F2L81:
	UpdateType2 1, -17, MA6_F2L98	;+30
;************************************************************************
MA6_F2L98:
	UpdateType2 1, -1, MA6_F2L99	;+30
;************************************************************************
MA6_F2L99:
	UpdateType2 1, -16, MA6_F2L115	;+30
;************************************************************************
MA6_F2L115:
	UpdateType2 1, -1, MA6_F2L116	;+30
;************************************************************************
MA6_F2L116:
	UpdateType2 1, -17, MA6_F2L133	;+30
;************************************************************************
MA6_F2L133:
	UpdateType2 1, -1, MA6_F2L134	;+30
;************************************************************************
MA6_F2L134:
	UpdateType2 1, -16, MA6_F2L150	;+30
;************************************************************************
MA6_F2L150:
	UpdateType2 1, -1, MA6_F2L151	;+30
;************************************************************************
MA6_F2L151:
	UpdateType2 1, -17, MA6_F2L168	;+30
;************************************************************************
MA6_F2L168:
	UpdateType2 1, -1, MA6_F2L169	;+30
;************************************************************************
MA6_F2L169:
	UpdateType2 1, -16, MA6_F2L185	;+30
;************************************************************************
MA6_F2L185:
	UpdateType2 1, -1, MA6_F2L186	;+30
;************************************************************************
MA6_F2L186:
	UpdateType2 1, -17, MA6_F2L203	;+30
;************************************************************************
MA6_F2L203:
	UpdateType2 1, -1, MA6_F2L204	;+30
;************************************************************************
MA6_F2L204:
	UpdateType2 1, -16, MA6_F2L220	;+30
;************************************************************************
MA6_F2L220:
	UpdateType2 1, -1, MA6_F2L221	;+30
;************************************************************************
MA6_F2L221:
	UpdateType2 1, -17, MA6_F2L238	;+30
;************************************************************************
MA6_F2L238:
	UpdateType2 1, -1, MA6_F2L239	;+30
;************************************************************************
MA6_F2L239:
	UpdateType2 1, -16, MA6_F2L255	;+30
;************************************************************************
MA6_F2L255:
	UpdateType2 1, -1, MA6_F2L256	;+30
;************************************************************************
MA6_F2L256:
	UpdateType2 1, -27, MA6_F1L20	;+30

END